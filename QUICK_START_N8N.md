# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: Bitrix24 + n8n

## –ó–∞–ø—É—Å–∫ –∑–∞ 3 –º–∏–Ω—É—Ç—ã

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ REST API —Å–µ—Ä–≤–µ—Ä

```bash
cd /path/to/bitrix24-mcp-server
npm run build
npm run start:n8n
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:3001`

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

```bash
curl http://localhost:3001/health
curl http://localhost:3001/validate
```

### 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ n8n

## üìù –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º

### –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç
```
POST http://localhost:3001/contacts
Body:
{
  "NAME": "–ò–≤–∞–Ω",
  "LAST_NAME": "–ü–µ—Ç—Ä–æ–≤",
  "EMAIL": [{"VALUE": "ivan@example.com", "VALUE_TYPE": "WORK"}],
  "PHONE": [{"VALUE": "+7 999 123 4567", "VALUE_TYPE": "MOBILE"}]
}
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
```
GET http://localhost:3001/contacts?start=0
```

### –°–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É
```
POST http://localhost:3001/deals
Body:
{
  "TITLE": "–ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞",
  "OPPORTUNITY": "50000",
  "CURRENCY_ID": "RUB",
  "CONTACT_ID": "123"
}
```

### –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ª–∏–¥—ã
```
GET http://localhost:3001/leads/latest?limit=10
```

### –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
```
POST http://localhost:3001/tasks
Body:
{
  "TITLE": "–ó–∞–¥–∞—á–∞",
  "RESPONSIBLE_ID": "1",
  "PRIORITY": "1"
}
```

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```
GET http://localhost:3001/analytics/user-performance?userId=1&startDate=2024-01-01&endDate=2024-12-31
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ n8n –Ω–æ–¥—ã

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–¥—É **HTTP Request**
2. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥ (GET/POST/PUT)
3. –£–∫–∞–∂–∏—Ç–µ URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
4. –î–ª—è POST/PUT —É–∫–∞–∂–∏—Ç–µ Body –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON

## üí° –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ª–∏–¥ –∏–∑ —Ñ–æ—Ä–º—ã ‚Üí –ö–æ–Ω—Ç–∞–∫—Ç ‚Üí –°–¥–µ–ª–∫–∞

1. **Webhook** - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
2. **HTTP POST /contacts** - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞
3. **HTTP POST /deals** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏ —Å ID –∫–æ–Ω—Ç–∞–∫—Ç–∞
4. **HTTP POST /tasks** - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—É

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç

1. **Schedule Trigger** - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00
2. **HTTP GET /analytics/user-performance** - –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤—á–µ—Ä–∞
3. **Function** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **Email** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Google Sheets

1. **Schedule Trigger** - –∫–∞–∂–¥—ã–π —á–∞—Å
2. **HTTP GET /deals** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫
3. **Google Sheets** - –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö

## üêõ Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞:** Connection refused
- **–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: `npm run start:n8n`

**–ü—Ä–æ–±–ª–µ–º–∞:** 401 Unauthorized
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook –≤ `.env` —Ñ–∞–π–ª–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å—Ç—å rate limit 2 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ–∫

## üìö –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º–æ—Ç—Ä–∏—Ç–µ `N8N_INTEGRATION.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å Bitrix24 —á–µ—Ä–µ–∑ n8n üéâ
